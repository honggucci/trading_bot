# Session Backup - 2026-01-16 16:30

## 작업 요약

### 목표
- RSI Divergence + Fibonacci 트레이딩 전략 분석
- bc3e19a 설정 (16 trades, 50% 승률, +$28.92) 재현 및 분석

---

## 현재 전략 설정 (bc3e19a 기준)

```python
# Config
sl_atr_mult: float = 1.5          # SL = entry ± 1.5*ATR
rsi_period: int = 14
stoch_rsi_period: int = 26

# StochRSI 임계값
oversold_threshold: 20
overbought_threshold: 80

# Fib
fib_tolerance_pct: 0.01           # 1% 고정

# 다이버전스
- Regular 다이버전스만 사용 (Hidden 제외)
```

---

## 백테스트 결과 비교

### 2021-11 (기준 기간)
| 전략 | 트레이드 | 승률 | PnL |
|------|---------|------|-----|
| **Strategy A** | 16 | 50% | +$28.92 |
| Strategy B (Fib only) | 451 | 29.5% | -$2,136.77 |

### 방향별 분석 (2021-11)
| 방향 | 트레이드 | 승률 | PnL | 시장 상태 |
|------|---------|------|-----|----------|
| LONG | 8 | 25% | -$49.04 | 하락장 (-7%) |
| SHORT | 8 | 75% | +$77.96 | 하락장 (-7%) |

**핵심 발견**: 추세 반대 방향 = 손실, 추세 순응 방향 = 수익

---

## 2026-01 vs 2021-11 차이 분석

### ATR/Price 비율 차이
| 기간 | 가격대 | ATR | ATR/Price | SL 금액 |
|------|--------|-----|-----------|---------|
| 2021-11 | $60,000 | $292 | 0.486% | $438 |
| 2026-01 | $95,000 | $235 | 0.247% | $352 |

- 2026년 ATR/Price 비율이 49% 낮음
- SL이 실질적으로 4.2x 더 타이트함

### 시장 레짐 차이
| 기간 | 방향 | 수익률 |
|------|------|--------|
| 2021-11 | 하락 | -7% |
| 2026-01 | 상승 | +9% |

---

## 핵심 딜레마

### 원래 전략 의도
```
급락/급등 → 비효율성 → 평균회귀로 수익
```

### 실제 결과
```
추세장에서 "비효율"이 아니라 "가격 발견"일 수 있음
RSI 다이버전스 = "과매도니까 반등할 것"
vs
강한 추세 = "과매도가 더 과매도될 수 있음"
```

---

## 선택지

### 1. 추세 필터 추가
- 상위 TF(4H/1D) 추세 방향으로만 진입
- 장점: 승률 대폭 상승
- 단점: 트레이드 수 절반

### 2. 양방향 유지 + 더 엄격한 필터
- 다이버전스 강도, 멀티TF 합의 등
- 장점: 기회 유지
- 단점: 여전히 역추세 리스크

### 3. 비효율성 정의 변경
- "급락"이 아니라 "급락 후 흡수 확인"
- 예: 급락 → 거래량 스파이크 → 가격 안정 → 진입

---

## 수정된 파일
- `scripts/backtest_strategy_compare.py`
  - StochRSI 임계값: 20/80
  - sl_atr_mult: 1.5
  - Regular 다이버전스만 사용

---

## 다음 결정 필요
- 추세 필터 도입 여부
- 또는 양방향 유지하며 필터 강화
- 또는 "비효율성" 정의 자체 변경
